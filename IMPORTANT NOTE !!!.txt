NEED TO FIX FOR SOME OF FUNCTION AND ADDED NEW FUNCTION TOO